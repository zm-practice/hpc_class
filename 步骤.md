1. # cmake生成构建系统
- CMakeLists.txt
  项目的构建规则文件，通常放在项目根目录
```shell
cmake_minimum_required(VERSION 3.10) #最低cmake版本
project(MyProject) #项目名称

# 定义一个选项，用于控制是否启用调试模式
option(ENABLE_DEBUG "Enable debug mode" OFF)

# 根据选项的值，设置不同的编译选项
if(ENABLE_DEBUG)
    add_definitions(-DDEBUG)
    set(CMAKE_BUILD_TYPE Debug)
else()
    set(CMAKE_BUILD_TYPE Release)
endif()

# 添加可执行文件
add_executable(myapp main.cpp) #myapp是生成的可执行文件名称，main.cpp是编译所需的源代码文件（可以指定多个文件）
```
![alt text](image-1.png)
2. # matmul 
makefile
```makefile
CXX = g++   // 定义C++编译器为g++，CXX是约定俗成表示C++编译器的变量名

CXXFLAGS =  -g -fopenmp //定义编译选项，-g表示生成调试信息，方便调试程序,-fopenmp 用于开启OpenMP支持，可以实现并行计算

INCLUDE = -I./include //指定头文件搜索路径，-I 是g++指定头文件路径的选项，这里指定为当前目录下的include文件夹

SRC = src/main.cpp src/file_operations.cpp src/matrix_operations.cpp //定义源文件列表
OBJ = $(SRC:.cpp=.o) //通过模式替换，将源文件列表转换为目标文件列表(.cpp后缀转化为.o)
TARGET = matmul_main //定义最终要生成的可执行文件名

all: $(TARGET)     // all 是Makefile的默认目标，这里表示构建的最终目标是生成 $(TARGET)（即可执行文件 matmul_main）
	@echo "编译完成，$(TARGET) 为最后生成目标"

$(TARGET): $(OBJ)
	$(CXX) $(CXXFLAGS) -o $@ $^ //表示生成 $(TARGET)  （可执行文件 matmul_main  ）依赖于 $(OBJ)  （所有目标文件）。

%.o: %.cpp  //模式规则，表示所有 .o  目标文件的构建依赖于对应的 .cpp  源文件。
	$(CXX) $(CXXFLAGS) -c $< -o $@ $(INCLUDE)//使用 g++ 编译器和编译选项，-c选项表示只编译不链接，生成目标文件。$< 表示第一个依赖（即 .cpp  源文件），-o 后接目标文件（ $@ ），同时指定头文件搜索路径 $(INCLUDE)  

clean:
	rm -f $(OBJ) $(TARGET) result.txt  //使用 rm  命令删除所有目标文件 $(OBJ)  、可执行文件 $(TARGET)  以及名为 result.txt  的文件 ， -f  选项表示强制删除，不提示。
```
# 运行matmul
- 进入项目目录
`cd /mnt/hgfs/hpc_class3/hpc_class/matmul`

- 清理并编译
`make clean && make`

- 运行程序（根据README确认参数）
`./matmul_main  # 或实际生成的可执行文件名`
![alt text](image-2.png)

## matmul_baseline基础实现
![alt text](image-3.png)
**30764.609000ms**
## matmul_Ofast使用 `-Ofast` 编译器优化
再makefile中多了以下语句
CXXFLAGS =  -g -fopenmp **-Ofast -march=native**
INCLUDE = -I./include **-Ofast -march=native**
- 先makefile
  ![alt text](image-4.png)
- ![alt text](image-5.png)